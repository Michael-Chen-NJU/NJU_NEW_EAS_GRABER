# 南京大学新版教务系统抢课程序

## 使用方式

该js脚本只建议在选课开始阶段（整点开放瞬间）使用，有限时间内登录信息会失效

1. 首先，登录新版抢课系统，选择轮次，进入课程列表界面
2. \*若选课不止一个轮次，需要手动修改选课轮次，这时需要调用相关函数，获取选课轮次并修改相关变量，手动构造选课列表
3. 在浏览器(chrome，edge，firefox)中，按F12打开开发者工具，打开控制台(console)，将js代码全部复制进控制台，回车
4. 调用grab_favorite(time_gap/\*时间间隔，以微秒为单位\*/)，即可抢课

## 更新说明

2025-9-16 版本修复：
1. 现在所有选课请求都会经过AES加密处理，符合新版教务系统安全要求
2. 修复了选课轮次默认选择问题（现在默认选择第二个轮次）
3. 请求数据现在包含时间戳防止重复提交

## 加密说明

系统使用以下加密方式：
- 算法: AES/ECB/PKCS7Padding
- 密钥: 从window.avy获取
- 数据格式: JSON字符串 + "?timestrap=" + 时间戳

如果遇到加密错误，请检查：
1. 确保已加载CryptoJS库
2. 确认window.avy变量存在
3. 时间戳格式是否正确